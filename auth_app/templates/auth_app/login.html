{% extends "auth_app/base_auth.html" %} 
{% block title %} Login | Cattendance{%endblock %} 
{% block content %}
<h1 class="font-semibold text-[24px] mb-2 text-center">Welcome Back</h1>
<h1 class="text-[14px] text-[rgb(123,137,157)] mb-6 text-center">
  Sign in as a
  <span
    id="role-text"
    class="font-semibold border-[1px] px-3 rounded-2xl border-[#a2314b] text-[#a2314b] bg-white"
  >
    Student
  </span>
</h1>

<form method="post" class="flex flex-col gap-4">
  {% csrf_token %}

  <!-- kuha selected role from base_auth.html -->
  <input
    type="hidden"
    name="selected_role"
    id="selected-role"
    value="student"
  />

  <!-- email -->
  <div class="space-y-2 relative">
    <label class="text-[14px] font-semibold">Email</label>
    <div class="relative">
      <input
        type="email"
        name="email"
        placeholder="Enter your email"
        class="peer w-full placeholder:text-[14px] bg-[#f6f7f8] pl-10 py-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#a2314b] focus:border-[#c9c9c9] transition"
      />
      <i
        class="fa-solid fa-envelope absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 peer-focus:text-[#a2314b] transition-colors"
      ></i>
    </div>
  </div>

  <!-- pass -->
  <div class="space-y-2 relative">
    <label class="text-[14px] font-semibold">Password</label>
    <div class="relative">
      <input
        type="password"
        id="password"
        name="password"
        placeholder="Enter your password"
        class="peer w-full placeholder:text-[14px] bg-[#f6f7f8] pl-10 pr-10 py-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#a2314b] focus:border-[#c9c9c9] transition"
      />
      <i
        class="fa-solid fa-lock absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 peer-focus:text-[#a2314b] transition-colors"
      ></i>
      <!-- Eye toggle -->
      <i
        id="togglePassword"
        class="fa-solid fa-eye absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 cursor-pointer"
      ></i>
    </div>
  </div>

  <div class="flex items-center justify-between text-[14px] mt-1">
    <label class="flex items-center gap-2">
      <input
        type="checkbox"
        name="remember_me"
        class="w-4 h-4 text-[#a2314b] border-gray-300 rounded focus:ring-[#a2314b]"
      />
      <span class="text-gray-600">Remember me</span>
    </label>
    <a href="#" class="text-[#a2314b] hover:underline">Forgot password?</a>
  </div>

  <!-- Submit -->
  <div class="mt-4">
    <button
      type="submit"
      class="w-full py-2 text-[14px] bg-gradient-to-r from-[#a2314b] to-[#d64648] text-white rounded flex items-center justify-center gap-2 group"
    >
      Sign in
      <i
        class="fa-solid fa-arrow-right transition-transform duration-200 group-hover:translate-x-2"
      ></i>
    </button>
  </div>
</form>

<p class="mt-4 text-[14px] text-center text-gray-600">
  Donâ€™t have an account?
  <a href="{% url 'auth_app:register' %}" class="text-[#a2314b] hover:underline"
    >Register</a
  >
</p>

<!--  DISPLAY DJANGO MESSAGES (SUCCESS/ERROR) -->
{% if messages %} {% for message in messages %}
<div
  class="mt-4 p-3 text-center items-center rounded-lg text-sm font-medium {% if message.tags == 'error' %}bg-red-100 text-red-700 border border-red-300{% elif message.tags == 'success' %}bg-green-100 text-green-700 border border-green-300{% elif message.tags == 'warning' %}bg-yellow-100 text-yellow-700 border border-yellow-300{% else %}bg-blue-100 text-blue-700 border border-blue-300{% endif %}"
>
  {{ message }}
</div>
{% endfor %} {% endif %}

<!-- JS for eye toggle and role selection -->
<script>
  const togglePassword = document.querySelector("#togglePassword");
  const password = document.querySelector("#password");

  togglePassword.addEventListener("click", function () {
    const type =
      password.getAttribute("type") === "password" ? "text" : "password";
    password.setAttribute("type", type);

    this.classList.toggle("fa-eye");
    this.classList.toggle("fa-eye-slash");
  });

  //  CONNECT ROLE SELECTOR TO FORM - This gets called from base_auth.html
  function updateSelectedRole(role) {
    const hiddenRoleField = document.getElementById("selected-role");
    if (hiddenRoleField) {
      hiddenRoleField.value = role;
    }
  }
</script>
{% endblock %}
